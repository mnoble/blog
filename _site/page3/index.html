<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="google-site-verification" content="uPo9ejFsAXhqlhxbsrVtWkBWHQQDUGvP5lSSqj5Mb54" />
    
    <title>MATTENOBLE - Ruby, Software Development and other Stuff.</title>
    
    <link rel="stylesheet" type="text/css" href="/public/css/main.css" media="all">
    <link rel="stylesheet" type="text/css" href="/public/css/clouds.css" media="all">
    <script type="text/javascript" src="http://use.typekit.com/npn1una.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body>
    <div id="wrap">
        <h1>
            <a href="/">
                <p>MATTENOBLE</p>
                <img src="/public/images/gem.png" alt="rubygem" />
                <div style="clear:both;"></div>
            </a>
        </h1>
        
        <div id="content">
            <div id="articles">
                
<div class="article">
    <h2><a href="/2011/03/22/forge-python-fixture-replacement/">Forge - Python Fixture Replacement</a></h2>
    <p>I found myself wanting a simple way to create objects with fake data for unit tests, in Python. I always liked <a href="https://github.com/thoughtbot/factory_girl">factory_girl</a> and the way it keeps things clean and coherent. However, Ruby libraries were no help to me here, directly at least, I needed a Python solution.</p>
<p>I wanted something that wasn&#8217;t fixtures. First of all, I don&#8217;t think you should need a database to run unit tests. If you&#8217;re writing simple, modular code you should be able to give input and test output. So my answer to that need is <a href="https://github.com/mnoble/forge">Forge</a>.</p>
<p>Forge is a very simple object creator loosely based on factory_girl. You define factories and then you build them. What I really like about this approach is that it makes your intent quite obvious. Testing something to with a confirmed user? <code>confirmed_user = Forge('confirmed_user')</code>. Simple, clean and easy to follow.</p>
<p>If you&#8217;re familiar with factory_girl at all, this will be nothing new for you. For those of you who aren&#8217;t, here&#8217;s a quick rundown on how to use Forge.</p>
<h3>Defining Factories</h3>
<p>First create a <code>project/test/factories</code> directory. You can either define all your factories in the <code>__init__.py</code> file or in separate files then import them in <code>__init__.py</code>.</p>
<pre class="clouds">
<span class="Comment"><span class="Comment">#</span> project/test/factories/user.py</span>
<span class="Keyword">from</span> forge <span class="Keyword">import</span> Forge

<span class="Keyword">with</span> Forge.define(<span class="String"><span class="String">'</span>user<span class="String">'</span></span>) <span class="Keyword">as</span> f:
    f.name      <span class="KeywordOperator">=</span> <span class="String"><span class="String">'</span>Matte<span class="String">'</span></span>
    f.age       <span class="KeywordOperator">=</span> <span class="Number">24</span>
    f.confirmed <span class="KeywordOperator">=</span> <span class="BuiltInConstant">False</span>

<span class="Keyword">with</span> Forge.define(<span class="String"><span class="String">'</span>confirmed_user<span class="String">'</span></span>) <span class="Keyword">as</span> f:
    f.name      <span class="KeywordOperator">=</span> <span class="String"><span class="String">'</span>Randy<span class="String">'</span></span>
    f.age       <span class="KeywordOperator">=</span> <span class="Number">67</span>
    f.confirmed <span class="KeywordOperator">=</span> <span class="BuiltInConstant">True</span>
</pre><pre class="clouds">
<span class="Comment"><span class="Comment">#</span> project/test/factories/__init__.py</span>
<span class="Keyword">import</span> user
</pre><h3>Building Forged Objects</h3>
<p>So now that you have a bank of factories for the different scenarios you&#8217;re testing. Time to get down to business. The <span class="caps">API</span> for creating factory objects mimics factory_girl&#8217;s:</p>
<pre class="clouds">
<span class="Keyword">import</span> project.test.factories
<span class="Keyword">from</span> forge <span class="Keyword">import</span> Forge

user <span class="KeywordOperator">=</span> Forge(<span class="String"><span class="String">'</span>user<span class="String">'</span></span>)
<span class="Comment"><span class="Comment">#</span> OR</span>
user <span class="KeywordOperator">=</span> Forge.build(<span class="String"><span class="String">'</span>user<span class="String">'</span></span>)
</pre><p>Unlike factory_girl, Forge will never put your objects into the database. It doesn&#8217;t even know how.</p>
<h3>Using Models</h3>
<p>When you&#8217;re working with an <span class="caps">ORM</span> you usually want objects that are as close to what it returns from a database query. Most of the time this is just achieved by instantiating a model class with your factory data. And that is exactly what Forge does. You can configure Forge to use a specific module to retrieve models from:</p>
<pre class="clouds">
Forge.configure(<span class="FunctionArgument">models</span><span class="KeywordOperator">=</span><span class="String"><span class="String">'</span>project.models<span class="String">'</span></span>)
</pre><p>Now, when you try to build a <code>user</code> factory, it will try to import <code>project.models.User</code>. If it exists, it will create an instance of it and apply the factory data to it. As long as your model&#8217;s constructor takes <code>**kwargs</code> of attributes, Forge should work just fine.</p>
<h3>Wrap Up</h3>
<p>Forge isn&#8217;t anything fancy, but it provides a uniform way to define and create real objects for tests. It keeps things organized, the intent clear and works out of the box. If you find yourself wanting to ditch the database in your unit tests, check it out.</p>
    <div style="clear:both;"></div> 
</div>

<div class="article">
    <h2><a href="/2011/02/08/a-developers-introduction-to-puppet/">A Developer's Introduction to Puppet</a></h2>
    <p><img src="/public/images/sock-puppet.jpg" class="right" title="Puppet" alt="Puppet" /></p>
<p><a href="http://www.puppetlabs.com/puppet/introduction/">Puppet</a> is one of those things most Rubyists have probably heard of, but few know very well. I&#8217;ve recently started using it in conjunction with Vagrant and found myself wanting a consolidated explanation of it&#8217;s components. So, here it is!</p>
<h3>Nodes</h3>
<p>A node represents a specific type of machine. It defines how, and with what, that type of server gets provisioned. Examples nodes would be like a web server, a mail server or an <span class="caps">LDAP</span> server.</p>
<h3>Modules</h3>
<p>Puppet modules are much like Ruby modules. They&#8217;re an organization tool which DRYs up your Puppet configs. Modules contain Classes, Templates, Files, etc. The Puppet site explains it well:</p>
<blockquote>
<p>Modules are reusable, sharable units of Puppet code. They can automate tasks such as setting up a database, web server, or mail server.</p>
</blockquote>
<h3>Classes</h3>
<p>Classes are the actual unit you can include into <em>nodes</em> or even other classes. Classes support a simplified type of inheritance. Say you want to use nginx as a web server one place, but as a proxy another. You&#8217;d have a base class, <code>nginx</code>, then a <code>nginx::proxy</code> class which modifies the base to act as a proxy server.</p>
<h3>Resources</h3>
<p>Resources are what classes contain. They&#8217;re a single item that is part of the overall configuration of a class. Take our <code>nginx</code> example above, to provision nginx on a machine we need a couple things. We need to ensure the package is installed, we want to make sure the service is running and we&#8217;d like to define a custom <code>nginx.conf</code>. These would all be resource definitions.</p>
<h3>Templates</h3>
<p>Templates are any file you want to put on the machine being provisioned. This can range from a <code>nginx.conf</code> file to <code>/etc/hosts</code>. You can include dynamic data by specifying class variables in your.. you guessed it, classes! These files are just <em>erb</em> so any normal Ruby goes.</p>
<h3>Just the Surface</h3>
<p>This is a very, very basic overview of Puppet. It&#8217;s an extremely powerful platform that can really make your life easier. I didn&#8217;t cover any examples of the Puppet <span class="caps">DSL</span> on purpose, I want this to just be a basic primer to Puppet&#8217;s concepts.</p>
<p>Check out <a href="http://docs.puppetlabs.com/">Puppet Labs&#8217; Documentation</a> for more information. Also, take a look into their <a href="http://forge.puppetlabs.com/">Module Forge</a> for preexisting modules you can use right now, with barely any work.</p>
    <div style="clear:both;"></div> 
</div>

<div class="article">
    <h2><a href="/2011/01/18/new-year-new-site/">New Year, New Site</a></h2>
    <p>As cliche as it may be, I&#8217;ve set a New Years resolution for myself; consistently update content on this blog.</p>
<p>I&#8217;ve wanted to resurrect this site for quite some time, but never got around to it. That is changing. I read an <a href="http://timeless.judofyr.net/your-blog-is-a-project">interesting article</a> recently that gave me some good ideas. A blog is very much like any other project and I&#8217;m going to start treating it like one.</p>
<p>When I&#8217;m designing, developing, writing, whatever, something that&#8217;s going to be public or seen by others, I obsess over every small detail. I need to take a more iterative approach to everything. Things don&#8217;t have to be perfect in their first incarnation. Or any incarnation for that matter.</p>
<h3>The Approach</h3>
<p>I&#8217;m going to set up an issue tracker for article ideas, issues, etc. I&#8217;m also going to start carry around a pocket journal to write down ideas throughout the day.</p>
<h3>Comments</h3>
<p>There will be no comments on this blog directly, at least initially. If there&#8217;s enough interest in the future I&#8217;ll add them, but for the time being they aren&#8217;t needed. Until then, I&#8217;ll let sites like Rubyflow and HackerNews support those conversations for me.</p>
    <div style="clear:both;"></div> 
</div>

            </div>
            
        
            <ul id="article-nav">
            
            
            
                <li id="next"><a href="/page2">Next &raquo;</a></li>
            
            </ul>
        
        </div>
        
        <div id="sidebar">
            <p id="bio">
                I'm Matte Noble, a Software Developer, Ruby
                enthusiast, Metalhead and all around curious guy.
                This is where I share things I know and learn.
            </p>
            
            <ul>
                <li id="archive"><a href="/archive/">Archive</a></li>
                <li id="rss"><a href="/atom.xml">RSS</a></li>
                <li id="twitter"><a href="http://twitter.com/mattenoble">@mattenoble</a></li>
                <li id="github"><a href="http://github.com/mnoble">github.com/mnoble</a></li>
            </ul>
        </div>
        
        <div style="clear:both;"></div>
    </div>
</body>
</html>