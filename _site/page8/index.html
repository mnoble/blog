<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta name="google-site-verification" content="uPo9ejFsAXhqlhxbsrVtWkBWHQQDUGvP5lSSqj5Mb54" />

  <title>MATTENOBLE - Ruby, Software Development and other Stuff.</title>

  <link rel="stylesheet" type="text/css" href="/public/css/main.css" media="all">
  <link rel="stylesheet" type="text/css" href="/public/css/highlight.css" media="all">

  <script type="text/javascript" src="http://use.typekit.com/npn1una.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>

<body>
  <section id="sidebar">
    <a href="/">
      <img src="/public/images/metal.png" alt="mattenoble" />
    </a>

    <section id="meta">
      <a href="https://github.com/mnoble" class="github">github</a>
      <a href="https://twitter.com/mattenoble" class="twitter">twitter</a>
      <a href="/atom.xm" class="rss">rss</a>
    </section>
  </section>

  <section id="content">
    
<div class="article">
    <h2>Forge - Python Fixture Replacement</h2>
    <p>I found myself wanting a simple way to create objects with fake data for unit tests, in Python. I always liked <a href="https://github.com/thoughtbot/factory_girl">factory_girl</a> and the way it keeps things clean and coherent. However, Ruby libraries were no help to me here, directly at least, I needed a Python solution.</p>
<p>I wanted something that wasn&#8217;t fixtures. First of all, I don&#8217;t think you should need a database to run unit tests. If you&#8217;re writing simple, modular code you should be able to give input and test output. So my answer to that need is <a href="https://github.com/mnoble/forge">Forge</a>.</p>
<p>Forge is a very simple object creator loosely based on factory_girl. You define factories and then you build them. What I really like about this approach is that it makes your intent quite obvious. Testing something to with a confirmed user? <code>confirmed_user = Forge('confirmed_user')</code>. Simple, clean and easy to follow.</p>
<p>If you&#8217;re familiar with factory_girl at all, this will be nothing new for you. For those of you who aren&#8217;t, here&#8217;s a quick rundown on how to use Forge.</p>
<h3>Defining Factories</h3>
<p>First create a <code>project/test/factories</code> directory. You can either define all your factories in the <code>__init__.py</code> file or in separate files then import them in <code>__init__.py</code>.</p>
<p>Liquid error: Output for xhtml in clouds style is not yet implemented</p>
<p>Liquid error: Output for xhtml in clouds style is not yet implemented</p>
<h3>Building Forged Objects</h3>
<p>So now that you have a bank of factories for the different scenarios you&#8217;re testing. Time to get down to business. The <span class="caps">API</span> for creating factory objects mimics factory_girl&#8217;s:</p>
<p>Liquid error: Output for xhtml in clouds style is not yet implemented</p>
<p>Unlike factory_girl, Forge will never put your objects into the database. It doesn&#8217;t even know how.</p>
<h3>Using Models</h3>
<p>When you&#8217;re working with an <span class="caps">ORM</span> you usually want objects that are as close to what it returns from a database query. Most of the time this is just achieved by instantiating a model class with your factory data. And that is exactly what Forge does. You can configure Forge to use a specific module to retrieve models from:</p>
<p>Liquid error: Output for xhtml in clouds style is not yet implemented</p>
<p>Now, when you try to build a <code>user</code> factory, it will try to import <code>project.models.User</code>. If it exists, it will create an instance of it and apply the factory data to it. As long as your model&#8217;s constructor takes <code>**kwargs</code> of attributes, Forge should work just fine.</p>
<h3>Wrap Up</h3>
<p>Forge isn&#8217;t anything fancy, but it provides a uniform way to define and create real objects for tests. It keeps things organized, the intent clear and works out of the box. If you find yourself wanting to ditch the database in your unit tests, check it out.</p>
</div>



    <ul id="archive">
      
      <li>
        <a href="/2011/08/20/csstree-an-ultra-simple-css-parser/" class="title">CSSTree - An ultra-simple CSS parser</a>
        <span>August 20, 2011</span>
      </li>
      
      <li>
        <a href="/2011/05/30/ruby-enumerables/" class="title">Ruby Enumerables</a>
        <span>May 30, 2011</span>
      </li>
      
      <li>
        <a href="/2011/05/12/tabby/" class="title">Tabby - iTerm2 Environments</a>
        <span>May 12, 2011</span>
      </li>
      
      <li>
        <a href="/2011/05/11/the-value-of-i-dont-know/" class="title">The Value of I Don't Know</a>
        <span>May 11, 2011</span>
      </li>
      
      <li>
        <a href="/2011/04/24/deferred-return-values-for-rspec-stubs/" class="title">Blocky RSpec Stubbing</a>
        <span>April 24, 2011</span>
      </li>
      
      <li>
        <a href="/2011/04/02/value-of-it-just-working/" class="title">Taking Care of Business</a>
        <span>April 02, 2011</span>
      </li>
      
      <li>
        <a href="/2011/03/30/TADDD/" class="title">Test and Design Driven Development</a>
        <span>March 30, 2011</span>
      </li>
      
      <li>
        <a href="/2011/03/22/forge-python-fixture-replacement/" class="title">Forge - Python Fixture Replacement</a>
        <span>March 22, 2011</span>
      </li>
      
      <li>
        <a href="/2011/02/08/a-developers-introduction-to-puppet/" class="title">A Developer's Introduction to Puppet</a>
        <span>February 08, 2011</span>
      </li>
      
      <li>
        <a href="/2011/01/18/new-year-new-site/" class="title">New Year, New Site</a>
        <span>January 18, 2011</span>
      </li>
      
    </ul>
  </section>
</body>
</html>
