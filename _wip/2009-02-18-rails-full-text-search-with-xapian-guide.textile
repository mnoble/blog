---
layout: post
title: Rails Full-Text Search with Xapian
date: 2009-02-18
---
bq. *Update*: This article is almost two years old. I'm taking the theme and rewriting it with up to date information.

*Feb 18, 2009* &mdash; The full-text search arena is filled with contenders like Sphinx, Ferret and even plain old MySQL solutions. One of the lesser known ones, as far as I can tell at least, is called Xapian. Its got a pretty interesting history and seems to perform just as well as any of the other options.

This guide will assumes you're deploying your application to a shared hosting environment. Files and directories should be downloaded, compiled or installed to somewhere in your home directory.

h3. The Setup

Create a place in your home directory to download and install everything.

{% uv shell-unix-generic %}
mkdir ~/opt
mkdir ~/opt/src
mkdir ~/opt/ruby_modules
cd ~/opt/src
{% enduv %}

h3. Xapian Core

{% uv shell-unix-generic %}
wget http://oligarchy.co.uk/xapian/1.2.4/xapian-core-1.2.4.tar.gz
tar zxvf xapian-core-1.2.4.tar.gz
cd xapian-core-1.2.4
./configure --prefix=$HOME/opt
make
make install
{% enduv %}

h3. Xapian Ruby Bindings

{% uv shell-unix-generic %}
wget http://oligarchy.co.uk/xapian/1.2.4/xapian-bindings-1.2.4.tar.gz
tar zxvf xapian-bindings-1.2.4.tar.gz
cd xapian-bindings-1.2.4
./configure --prefix=$HOME/opt RUBY_LIB=$HOME/opt/ruby RUBY_LIB_ARCH=$HOME/opt/ruby XAPIAN_CONFIG=$HOME/opt/bin/xapian-config
make
make install
{% enduv %}

h3. Showing Rails Where to Find the Bindings

{% uv %}
# Rails 2
# config/environment.rb
config.load_paths << File.expand_path("~/opt/lib")

# Rails 3
# config/application.rb
config.autoload_paths << Rails.root.join("opt", "ruby_modules")
{% enduv %}

h3. Xapit

"Xapit":https://github.com/ryanb/xapit is a Xapian library by Ryan Bates that has a nice and friendly API and is documented well. It's pretty dead simple to setup too. First, install it as a plugin.

{% uv shell-unix-generic %}

{% enduv %}

Next, setup our model to be searchable.

{% uv %}
class Person < 
{% enduv %}

